<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="Electron">
  <diagram name="PRD-Engine Compact Architecture" id="prd-compact-arch">
    <mxGraphModel dx="1800" dy="2100" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="1800" pageHeight="2100" math="0" shadow="0" defaultFontFamily="Arial">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

<!-- ################################################################ -->
<!-- ##                    ALL EDGES FIRST (Z-Order)               ## -->
<!-- ################################################################ -->

<!-- ====== MAIN FLOW ARROWS (solid, strokeWidth=2) ====== -->

<mxCell id="e-start-claude" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="start" target="read-claude">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-claude-scan" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="read-claude" target="sub-scan">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-scan-ckpt" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="sub-scan" target="dec-ckpt">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-ckpt-no" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;fontSize=12;fontStyle=1;endArrow=classic;endFill=1;" edge="1" parent="1" source="dec-ckpt" target="step0">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-ckpt-yes" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;fontSize=12;fontStyle=1;endArrow=classic;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="dec-ckpt" target="resume-box">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-resume-pm" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;dashed=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="resume-box" target="hat-pm">
  <mxGeometry relative="1" as="geometry">
    <Array as="points">
      <mxPoint x="760" y="390" />
      <mxPoint x="760" y="695" />
    </Array>
  </mxGeometry>
</mxCell>

<mxCell id="e-step0-doc" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="step0" target="dec-doc">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-doc-yes" value="Yes â€” has link" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;fontSize=11;endArrow=classic;endFill=1;" edge="1" parent="1" source="dec-doc" target="sub-doc">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-doc-no" value="No doc" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;fontSize=11;endArrow=classic;endFill=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="dec-doc" target="hat-pm">
  <mxGeometry relative="1" as="geometry">
    <Array as="points">
      <mxPoint x="280" y="510" />
      <mxPoint x="280" y="695" />
    </Array>
  </mxGeometry>
</mxCell>

<mxCell id="e-subdoc-pm" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="sub-doc" target="hat-pm">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-pm-qpm" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#6c8ebf;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="hat-pm" target="q-pm">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-qpm-arch" value="ðŸŽ© Switch to Architect" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;" edge="1" parent="1" source="q-pm" target="hat-arch">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-arch-qarch" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82b366;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="hat-arch" target="q-arch">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-qarch-fe" value="ðŸŽ© Switch to Frontend" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;" edge="1" parent="1" source="q-arch" target="hat-fe">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-fe-qfe" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#d6b656;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="hat-fe" target="q-fe">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-qfe-cr" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="q-fe" target="cross-review">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-cr-decgap" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="cross-review" target="dec-gaps">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-gaps-yes" value="Gaps found" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;fontFamily=Arial;fontSize=11;endArrow=classic;endFill=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="dec-gaps" target="cross-review">
  <mxGeometry relative="1" as="geometry">
    <Array as="points">
      <mxPoint x="290" y="1310" />
      <mxPoint x="290" y="1197" />
    </Array>
  </mxGeometry>
</mxCell>

<mxCell id="e-gaps-no" value="All clear" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;fontSize=11;endArrow=classic;endFill=1;" edge="1" parent="1" source="dec-gaps" target="gen-diff">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-diff-approve" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="gen-diff" target="dec-approve">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-approve-yes" value="Approved" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;fontSize=11;endArrow=classic;endFill=1;" edge="1" parent="1" source="dec-approve" target="write-epic">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-approve-no" value="Rejected" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;fontFamily=Arial;fontSize=11;endArrow=classic;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="dec-approve" target="gen-diff">
  <mxGeometry relative="1" as="geometry">
    <Array as="points">
      <mxPoint x="710" y="1505" />
      <mxPoint x="710" y="1412" />
    </Array>
  </mxGeometry>
</mxCell>

<mxCell id="e-epic-update" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="write-epic" target="update-idx">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-update-dec50" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;endArrow=classic;endFill=1;" edge="1" parent="1" source="update-idx" target="dec-context">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-ctx-no" value="OK" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#333333;fontFamily=Arial;fontSize=11;endArrow=classic;endFill=1;" edge="1" parent="1" source="dec-context" target="end-node">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-ctx-yes" value="&gt; 50%" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;fontFamily=Arial;fontSize=11;fontStyle=1;endArrow=classic;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="dec-context" target="compact-action">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<!-- ====== USER BIDIRECTIONAL ARROWS ====== -->

<mxCell id="e-user-qpm" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#6c8ebf;fontFamily=Arial;endArrow=classic;endFill=1;startArrow=classic;startFill=1;" edge="1" parent="1" source="user-actor" target="q-pm">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-user-qarch" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#82b366;fontFamily=Arial;endArrow=classic;endFill=1;startArrow=classic;startFill=1;" edge="1" parent="1" source="user-actor" target="q-arch">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-user-qfe" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#d6b656;fontFamily=Arial;endArrow=classic;endFill=1;startArrow=classic;startFill=1;" edge="1" parent="1" source="user-actor" target="q-fe">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<!-- ====== STORAGE/MEMORY ARROWS (dashed) ====== -->

<mxCell id="e-scan-mem" value="reads all" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#9673a6;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;dashed=1;" edge="1" parent="1" source="sub-scan" target="mem-group">
  <mxGeometry relative="1" as="geometry">
    <Array as="points">
      <mxPoint x="800" y="202" />
      <mxPoint x="800" y="410" />
    </Array>
  </mxGeometry>
</mxCell>

<mxCell id="e-arch-prd" value="reads context" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#82b366;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;dashed=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="hat-arch" target="cyl-prd">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-epic-folder" value="writes" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#b85450;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="write-epic" target="folder-epics">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-update-prd" value="updates" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#82b366;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;dashed=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;" edge="1" parent="1" source="update-idx" target="cyl-prd">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-update-ckpt" value="updates" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#6c8ebf;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;dashed=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;" edge="1" parent="1" source="update-idx" target="cyl-ckpt">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-docsrc-sub" value="read-only" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;strokeColor=#d6b656;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="doc-source" target="sub-doc">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<!-- ====== HOOK ARROWS (dashed, gray) ====== -->

<mxCell id="e-hook1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#999999;fontFamily=Arial;endArrow=classic;endFill=1;dashed=1;" edge="1" parent="1" source="hook-start" target="read-claude">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-hook2" value="saves" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#999999;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;dashed=1;" edge="1" parent="1" source="hook-compact" target="cyl-ckpt">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<mxCell id="e-hook3" value="saves + reflection" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#999999;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;dashed=1;" edge="1" parent="1" source="hook-stop" target="cyl-lessons">
  <mxGeometry relative="1" as="geometry" />
</mxCell>

<!-- ====== LESSONS LOOP (dashed, curved) ====== -->

<mxCell id="e-lessons-loop" value="learns from mistakes" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=1;strokeColor=#d6b656;fontFamily=Arial;fontSize=10;endArrow=classic;endFill=1;dashed=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="cyl-lessons" target="cyl-lessons">
  <mxGeometry relative="1" as="geometry">
    <Array as="points">
      <mxPoint x="1180" y="510" />
      <mxPoint x="1230" y="510" />
      <mxPoint x="1230" y="360" />
      <mxPoint x="1180" y="360" />
    </Array>
  </mxGeometry>
</mxCell>


<!-- ################################################################ -->
<!-- ##                    ALL VERTICES AFTER                      ## -->
<!-- ################################################################ -->

<!-- ==================== TITLE ==================== -->

<mxCell id="title" value="PRD-Engine â€” Compact Architecture v2.1.0" style="text;html=1;align=center;verticalAlign=middle;fontFamily=Arial;fontSize=26;fontStyle=1;fontColor=#1a1a2e;" vertex="1" parent="1">
  <mxGeometry x="250" y="-50" width="580" height="35" as="geometry" />
</mxCell>
<mxCell id="subtitle" value="Multi-Agent PRD Generation Framework â€” Compact Flowchart" style="text;html=1;align=center;verticalAlign=middle;fontFamily=Arial;fontSize=13;fontColor=#666666;" vertex="1" parent="1">
  <mxGeometry x="280" y="-18" width="520" height="20" as="geometry" />
</mxCell>

<!-- ==================== MAIN FLOW ==================== -->

<!-- 1. START (Terminal/Ellipse) -->
<mxCell id="start" value="SESSION START" style="ellipse;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=14;fontStyle=1;fillColor=#1a1a2e;strokeColor=#1a1a2e;fontColor=#ffffff;" vertex="1" parent="1">
  <mxGeometry x="410" y="25" width="200" height="50" as="geometry" />
</mxCell>

<!-- 2. Read CLAUDE.md (Process/Rectangle) -->
<mxCell id="read-claude" value="Read CLAUDE.md&#xa;Load 18 Iron Rules + settings.json" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=13;fillColor=#f5f5f5;strokeColor=#333333;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="370" y="100" width="280" height="50" as="geometry" />
</mxCell>

<!-- 3. Sub-Agent: Scan (Predefined Process = double-bar rect) -->
<mxCell id="sub-scan" value="Sub-Agent (Explore): Full Project Scan&#xa;SKILL.md + rules/ + lessons + prd-index + epics/" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;fontFamily=Arial;fontSize=12;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="340" y="175" width="340" height="55" as="geometry" />
</mxCell>

<!-- 4. Decision: checkpoint exists? (Diamond) -->
<mxCell id="dec-ckpt" value="checkpoint.json&#xa;exists?" style="rhombus;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=13;fillColor=#ffffff;strokeColor=#333333;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="405" y="255" width="210" height="100" as="geometry" />
</mxCell>

<!-- Resume box (right branch) -->
<mxCell id="resume-box" value="Resume at&#xa;saved position" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=12;fillColor=#f5f5f5;strokeColor=#666666;dashed=1;" vertex="1" parent="1">
  <mxGeometry x="690" y="365" width="130" height="50" as="geometry" />
</mxCell>

<!-- 5. Step 0: AskUserQuestion (Parallelogram = Input) -->
<mxCell id="step0" value="Step 0: AskUserQuestionTool&#xa;1) I have a doc link  2) No doc yet  3) From scratch" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=12;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fixedSize=1;" vertex="1" parent="1">
  <mxGeometry x="340" y="380" width="340" height="55" as="geometry" />
</mxCell>

<!-- 6. Decision: DOC_SOURCE? (Diamond) -->
<mxCell id="dec-doc" value="DOC_SOURCE&#xa;provided?" style="rhombus;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=13;fillColor=#ffffff;strokeColor=#333333;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="405" y="460" width="210" height="100" as="geometry" />
</mxCell>

<!-- 7. Sub-Agent: Read DOC_SOURCE (Predefined Process) -->
<mxCell id="sub-doc" value="Sub-Agent (Explore):&#xa;Read DOC_SOURCE via WebFetch&#xa;Return requirements summary" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;fontFamily=Arial;fontSize=12;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="365" y="585" width="290" height="55" as="geometry" />
</mxCell>

<!-- ========== PM HAT (Blue Section) ========== -->

<mxCell id="hat-pm" value="PM Hat â€” Read product-manager/SKILL.md&#xa;Business perspective: Users, Problems, Stories" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=13;fontStyle=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="355" y="670" width="310" height="50" as="geometry" />
</mxCell>

<mxCell id="q-pm" value="9 Questions: Target User, Problem, User Stories,&#xa;Acceptance Criteria, Priority, Errors/Funnel,&#xa;Roles Table, KPIs, 2030 Recommendations" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;fixedSize=1;" vertex="1" parent="1">
  <mxGeometry x="330" y="740" width="360" height="65" as="geometry" />
</mxCell>

<!-- ========== ARCHITECT HAT (Green Section) ========== -->

<mxCell id="hat-arch" value="Architect Hat â€” Read architect/SKILL.md&#xa;+ Load prd-index.json for cross-epic context" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=13;fontStyle=1;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="345" y="835" width="330" height="50" as="geometry" />
</mxCell>

<mxCell id="q-arch" value="8 Questions: Entities, Relations, API Endpoints,&#xa;Validations, Error Codes, Logging, Dependencies,&#xa;2030 Recs â€” each tagged: MVP / Future / User Decides" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;fixedSize=1;" vertex="1" parent="1">
  <mxGeometry x="320" y="905" width="380" height="65" as="geometry" />
</mxCell>

<!-- ========== FRONTEND HAT (Yellow Section) ========== -->

<mxCell id="hat-fe" value="Frontend Hat â€” Read frontend/SKILL.md&#xa;UI/UX perspective: Screens, States, Interactions" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=13;fontStyle=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="350" y="1000" width="320" height="50" as="geometry" />
</mxCell>

<mxCell id="q-fe" value="Q0: Reference image? + Q1-Q11: Layout,&#xa;Error Display (3 levels), Loading, Responsive,&#xa;Accessibility, i18n, Design System, Animations" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=11;fillColor=#fff2cc;strokeColor=#d6b656;fixedSize=1;" vertex="1" parent="1">
  <mxGeometry x="320" y="1070" width="380" height="65" as="geometry" />
</mxCell>

<!-- ========== CROSS-REVIEW (Red Section) ========== -->

<mxCell id="cross-review" value="Cross-Review â€” 7 Mandatory Checks&#xa;1) PM Coverage  2) Tech Consistency  3) Frontend Mapping&#xa;4) Analytics (12+ events)  5) SEO  6) i18n  7) Deferred Docs" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=12;fontStyle=0;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="330" y="1165" width="360" height="65" as="geometry" />
</mxCell>

<!-- Decision: Gaps? (Diamond) -->
<mxCell id="dec-gaps" value="Gaps or&#xa;contradictions?" style="rhombus;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=13;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="405" y="1260" width="210" height="100" as="geometry" />
</mxCell>

<!-- Generate Diff (Process) -->
<mxCell id="gen-diff" value="Generate Diff &amp; Display to User&#xa;(Rule 9: Diff before write!)" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=12;fillColor=#f5f5f5;strokeColor=#333333;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="370" y="1390" width="280" height="45" as="geometry" />
</mxCell>

<!-- Decision: Approve? (Diamond) -->
<mxCell id="dec-approve" value="User&#xa;approves?" style="rhombus;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=13;fillColor=#ffffff;strokeColor=#333333;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="410" y="1460" width="200" height="90" as="geometry" />
</mxCell>

<!-- Write Epic (Document shape) -->
<mxCell id="write-epic" value="Write epics/XX-name.md&#xa;Parts A + B + C + D + Key Decisions" style="shape=document;whiteSpace=wrap;html=1;boundedLbl=1;fontFamily=Arial;fontSize=13;fontStyle=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="380" y="1580" width="260" height="60" as="geometry" />
</mxCell>

<!-- Update Indexes (Process) -->
<mxCell id="update-idx" value="Update prd-index.json + checkpoint.json&#xa;Epic marked as completed" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=12;fillColor=#f5f5f5;strokeColor=#333333;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="370" y="1665" width="280" height="45" as="geometry" />
</mxCell>

<!-- Decision: 50% Context? (Diamond) -->
<mxCell id="dec-context" value="Context&#xa;&gt; 50%?" style="rhombus;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=13;fillColor=#ffffff;strokeColor=#b85450;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="415" y="1735" width="190" height="90" as="geometry" />
</mxCell>

<!-- Compact action (right branch) -->
<mxCell id="compact-action" value="Save ALL + Warn User&#xa;Suggest /compact or new session" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=11;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=1;" vertex="1" parent="1">
  <mxGeometry x="680" y="1755" width="220" height="45" as="geometry" />
</mxCell>

<!-- END (Terminal/Ellipse) -->
<mxCell id="end-node" value="END â€” Epic Ready for Dev!" style="ellipse;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=14;fontStyle=1;fillColor=#1a1a2e;strokeColor=#1a1a2e;fontColor=#ffffff;" vertex="1" parent="1">
  <mxGeometry x="410" y="1860" width="200" height="50" as="geometry" />
</mxCell>


<!-- ==================== USER (Actor, left side) ==================== -->

<mxCell id="user-actor" value="User" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;fontFamily=Arial;fontSize=13;fontStyle=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
  <mxGeometry x="115" y="870" width="40" height="60" as="geometry" />
</mxCell>

<mxCell id="user-note" value="All questions via&#xa;AskUserQuestionTool&#xa;with structured options" style="text;html=1;align=center;verticalAlign=middle;fontFamily=Arial;fontSize=10;fontColor=#666666;fontStyle=2;" vertex="1" parent="1">
  <mxGeometry x="60" y="940" width="150" height="45" as="geometry" />
</mxCell>


<!-- ==================== HOOKS (Hexagons, left side) ==================== -->

<mxCell id="hooks-title" value="Hooks (Automatic)" style="text;html=1;align=center;verticalAlign=middle;fontFamily=Arial;fontSize=12;fontStyle=1;fontColor=#666666;" vertex="1" parent="1">
  <mxGeometry x="40" y="20" width="140" height="20" as="geometry" />
</mxCell>

<mxCell id="hook-start" value="SessionStart&#xa;startup.sh" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=11;fillColor=#f5f5f5;strokeColor=#999999;fixedSize=1;" vertex="1" parent="1">
  <mxGeometry x="40" y="50" width="140" height="50" as="geometry" />
</mxCell>

<mxCell id="hook-compact" value="PreCompact&#xa;pre-compact.sh" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=11;fillColor=#f5f5f5;strokeColor=#999999;fixedSize=1;" vertex="1" parent="1">
  <mxGeometry x="40" y="120" width="140" height="50" as="geometry" />
</mxCell>

<mxCell id="hook-stop" value="Stop&#xa;auto-checkpoint.sh" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=11;fillColor=#f5f5f5;strokeColor=#999999;fixedSize=1;" vertex="1" parent="1">
  <mxGeometry x="40" y="190" width="140" height="50" as="geometry" />
</mxCell>


<!-- ==================== DOC_SOURCE (Document, right side) ==================== -->

<mxCell id="doc-source" value="DOC_SOURCE&#xa;Google Doc / Notion / PDF&#xa;(Read-Only!)" style="shape=document;whiteSpace=wrap;html=1;boundedLbl=1;fontFamily=Arial;fontSize=12;fontStyle=0;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" vertex="1" parent="1">
  <mxGeometry x="830" y="570" width="190" height="75" as="geometry" />
</mxCell>


<!-- ==================== MEMORY SYSTEM (Swimlane, right side) ==================== -->

<mxCell id="mem-group" value=".claude/memory/ â€” Persistent Storage" style="swimlane;startSize=28;fontFamily=Arial;fontSize=13;fontStyle=1;fillColor=#f5f5f5;strokeColor=#666666;rounded=1;swimlaneLine=1;" vertex="1" parent="1">
  <mxGeometry x="830" y="340" width="460" height="380" as="geometry" />
</mxCell>

<!-- Cylinders inside Memory -->
<mxCell id="cyl-ckpt" value="checkpoint.json&#xa;~200 tokens&#xa;Where we stopped" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;fontFamily=Arial;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;size=10;" vertex="1" parent="mem-group">
  <mxGeometry x="20" y="45" width="130" height="80" as="geometry" />
</mxCell>

<mxCell id="cyl-prd" value="prd-index.json&#xa;~500 tokens&#xa;All entities, APIs,&#xa;cross-epic relations" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;fontFamily=Arial;fontSize=11;fillColor=#d5e8d4;strokeColor=#82b366;size=10;" vertex="1" parent="mem-group">
  <mxGeometry x="170" y="45" width="130" height="90" as="geometry" />
</mxCell>

<mxCell id="cyl-lessons" value="lessons.md&#xa;Long-term memory&#xa;Mistake â†’ Pattern&#xa;â†’ Rule â†’ Improve" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;fontFamily=Arial;fontSize=11;fillColor=#fff2cc;strokeColor=#d6b656;size=10;" vertex="1" parent="mem-group">
  <mxGeometry x="320" y="45" width="120" height="90" as="geometry" />
</mxCell>

<mxCell id="folder-epics" value="epics/&#xa;01-user-auth.md&#xa;02-product-catalog.md&#xa;..." style="shape=folder;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=11;fillColor=#f8cecc;strokeColor=#b85450;tabWidth=50;tabHeight=15;" vertex="1" parent="mem-group">
  <mxGeometry x="20" y="170" width="170" height="90" as="geometry" />
</mxCell>

<mxCell id="session-init" value="session-init.json&#xa;Sub-agent verification" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;fontFamily=Arial;fontSize=10;fillColor=#e1d5e7;strokeColor=#9673a6;size=8;" vertex="1" parent="mem-group">
  <mxGeometry x="210" y="185" width="120" height="65" as="geometry" />
</mxCell>

<mxCell id="mem-note" value="Save Matrix:&#xa;checkpoint â†’ after every answer&#xa;prd-index â†’ only on epic complete&#xa;lessons â†’ on Stop hook" style="text;html=1;align=left;verticalAlign=top;fontFamily=Arial;fontSize=10;fontColor=#666666;fontStyle=2;" vertex="1" parent="mem-group">
  <mxGeometry x="210" y="265" width="230" height="55" as="geometry" />
</mxCell>

<mxCell id="epic-template" value="epic-template.md&#xa;Parts A + B + C + D" style="shape=document;whiteSpace=wrap;html=1;boundedLbl=1;fontFamily=Arial;fontSize=10;fillColor=#f5f5f5;strokeColor=#666666;" vertex="1" parent="mem-group">
  <mxGeometry x="20" y="285" width="140" height="50" as="geometry" />
</mxCell>


<!-- ==================== LEGEND (bottom right) ==================== -->

<mxCell id="legend-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Arial;fillColor=#ffffff;strokeColor=#cccccc;" vertex="1" parent="1">
  <mxGeometry x="830" y="1520" width="350" height="260" as="geometry" />
</mxCell>

<mxCell id="legend-title" value="Legend â€” Official Flowchart Shapes" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=14;fontStyle=1;" vertex="1" parent="1">
  <mxGeometry x="845" y="1525" width="300" height="25" as="geometry" />
</mxCell>

<mxCell id="leg-terminal" value="Start / End" style="ellipse;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=10;fillColor=#1a1a2e;fontColor=#ffffff;strokeColor=#1a1a2e;" vertex="1" parent="1">
  <mxGeometry x="850" y="1555" width="80" height="30" as="geometry" />
</mxCell>
<mxCell id="leg-terminal-txt" value="= Terminal (Start/End)" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;" vertex="1" parent="1">
  <mxGeometry x="940" y="1555" width="200" height="30" as="geometry" />
</mxCell>

<mxCell id="leg-process" value="Process" style="rounded=0;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=10;fillColor=#f5f5f5;strokeColor=#333333;" vertex="1" parent="1">
  <mxGeometry x="850" y="1590" width="80" height="30" as="geometry" />
</mxCell>
<mxCell id="leg-process-txt" value="= Action / Process Step" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;" vertex="1" parent="1">
  <mxGeometry x="940" y="1590" width="200" height="30" as="geometry" />
</mxCell>

<mxCell id="leg-decision" value="?" style="rhombus;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=10;fillColor=#ffffff;strokeColor=#333333;" vertex="1" parent="1">
  <mxGeometry x="860" y="1623" width="50" height="35" as="geometry" />
</mxCell>
<mxCell id="leg-decision-txt" value="= Decision (Yes/No branch)" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;" vertex="1" parent="1">
  <mxGeometry x="940" y="1625" width="200" height="30" as="geometry" />
</mxCell>

<mxCell id="leg-io" value="I/O" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fontFamily=Arial;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;fixedSize=1;" vertex="1" parent="1">
  <mxGeometry x="845" y="1660" width="90" height="30" as="geometry" />
</mxCell>
<mxCell id="leg-io-txt" value="= Input / Output (User dialog)" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;" vertex="1" parent="1">
  <mxGeometry x="940" y="1660" width="200" height="30" as="geometry" />
</mxCell>

<mxCell id="leg-predef" value="Sub" style="shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;fontFamily=Arial;fontSize=10;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
  <mxGeometry x="850" y="1695" width="80" height="30" as="geometry" />
</mxCell>
<mxCell id="leg-predef-txt" value="= Predefined Process (Sub-Agent)" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;" vertex="1" parent="1">
  <mxGeometry x="940" y="1695" width="220" height="30" as="geometry" />
</mxCell>

<mxCell id="leg-doc" value="Doc" style="shape=document;whiteSpace=wrap;html=1;boundedLbl=1;fontFamily=Arial;fontSize=10;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
  <mxGeometry x="855" y="1728" width="70" height="30" as="geometry" />
</mxCell>
<mxCell id="leg-doc-txt" value="= Document (file output)" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;" vertex="1" parent="1">
  <mxGeometry x="940" y="1728" width="200" height="30" as="geometry" />
</mxCell>

<mxCell id="leg-cyl" value="DB" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;fontFamily=Arial;fontSize=10;fillColor=#dae8fc;strokeColor=#6c8ebf;size=8;" vertex="1" parent="1">
  <mxGeometry x="860" y="1758" width="60" height="30" as="geometry" />
</mxCell>
<mxCell id="leg-cyl-txt" value="= Data Store (JSON / MD)" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;" vertex="1" parent="1">
  <mxGeometry x="940" y="1758" width="200" height="30" as="geometry" />
</mxCell>


<!-- ==================== ARROW LEGEND ==================== -->

<mxCell id="legend-arrows-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fontFamily=Arial;fillColor=#ffffff;strokeColor=#cccccc;" vertex="1" parent="1">
  <mxGeometry x="830" y="1795" width="350" height="130" as="geometry" />
</mxCell>

<mxCell id="legend-arrows-title" value="Arrow Types" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=13;fontStyle=1;" vertex="1" parent="1">
  <mxGeometry x="845" y="1800" width="150" height="20" as="geometry" />
</mxCell>

<mxCell id="leg-arrow-solid" value="Solid arrow (one-way) = main process flow" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;" vertex="1" parent="1">
  <mxGeometry x="850" y="1825" width="310" height="20" as="geometry" />
</mxCell>
<mxCell id="leg-arrow-bidir" value="Double arrow (two-way) = user dialog" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;fontColor=#6c8ebf;" vertex="1" parent="1">
  <mxGeometry x="850" y="1847" width="310" height="20" as="geometry" />
</mxCell>
<mxCell id="leg-arrow-dashed" value="Dashed arrow = data read/write (not main flow)" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;fontColor=#999999;" vertex="1" parent="1">
  <mxGeometry x="850" y="1869" width="310" height="20" as="geometry" />
</mxCell>
<mxCell id="leg-arrow-red" value="Red arrow = rejection / loop back / warning" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;fontColor=#b85450;" vertex="1" parent="1">
  <mxGeometry x="850" y="1891" width="310" height="20" as="geometry" />
</mxCell>
<mxCell id="leg-arrow-color" value="Arrow color matches agent: Blue=PM, Green=Arch, Yellow=FE" style="text;html=1;align=left;verticalAlign=middle;fontFamily=Arial;fontSize=10;fontColor=#333333;" vertex="1" parent="1">
  <mxGeometry x="850" y="1905" width="320" height="20" as="geometry" />
</mxCell>


      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
